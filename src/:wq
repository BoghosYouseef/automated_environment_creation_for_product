---
- name: Update repositories cache.
  apt:
    update_cache: yes
- name: Safe system upgrade via aptitude.
  apt:
    upgrade: safe
- name: install mysql
  apt:
    name: mysql-server
    state: present
- name: install python
  apt:
    name: python3-pymysql
    state: present
- name: start & enable server
  service:
    name: mysql
    state: started
    enabled: yes

- name: Install nvm
  ansible.builtin.shell: >
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash
  args:
    creates: "$HOME/.nvm/nvm.sh"
- name: verify installation of nvm
  command: -v nvm
- name: Install Node v15.14.0
  shell: nvm install v15.14.0
  become: no
  args:
    executable: /bin/bash

- name: add backend link to .env file of front end
  shell: echo "API_URL=http://localhost:8085/e4lapi" >> /vagrant_data/lu.uni.e4l.platform.frontend.dev/.env
  args:
    executable: /bin/bash

- name: run front end
  shell: npm i && npm run &
  args:
    executable: /bin/bash
    chdir: /vagrant_data/lu.uni.e4l.platform.frontend.dev/
